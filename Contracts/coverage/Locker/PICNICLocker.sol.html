<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for Locker\PICNICLocker.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">Locker/</a> PICNICLocker.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/31</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/24</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/11</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/35</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;
&nbsp;
// import "./IERC20.sol";
// import "./Ownable.sol";
// import "./SafeMath.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
import "@openzeppelin/contracts/utils/math/SafeMath.sol";
&nbsp;
&nbsp;
contract PICNICLocker is Ownable {
&nbsp;
    using SafeMath for uint;
    uint public lockerCount;    
&nbsp;
    uint public lockFee = 0.1 ether;
    uint public updateLokcerFee = 0.05 ether;
&nbsp;
    mapping(uint =&gt; Loker)  public loker;
    mapping(address =&gt; uint[])  lockersListByTokenAddress;
    mapping(address =&gt; uint[])  lockersListByUserAddress;
&nbsp;
    enum Status {LOCKED, WITHDRAWED}
    enum Type {TOKEN, LPTOKEN}
&nbsp;
    struct Loker {
        uint id;
        Type _type;
        address owner; 
        address tokenAddress;
        uint numOfTokens;
        uint lockTime;
        uint unlockTime;
        Status status;
    }
&nbsp;
    event Locked (uint id, address owner, address token, uint numOfTokens, uint unlockTime);
    event Unlocked (uint id, address owner, address token, uint numOfTokens);
&nbsp;
<span class="fstat-no" title="function not covered" >    modifier OnlyLockerOnwer(uint _id) {</span>
<span class="cstat-no" title="statement not covered" >        require(loker[_id].owner == _msgSender(), "Only locker onwer is allowed.")</span>; 
        _;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    modifier NotExpired(uint _id) {</span>
<span class="cstat-no" title="statement not covered" >        require(block.timestamp &lt; loker[_id].unlockTime, "The locker has been expired.")</span>;
        _;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    modifier Expired(uint _id) {</span>
<span class="cstat-no" title="statement not covered" >        require(block.timestamp &gt;= loker[_id].unlockTime, "Not unlocked yet.")</span>;
        _;
    }
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >    function lockTokens(Type _type, address _token, uint _numOfTokens, uint _unlockTime) payable public {</span>
<span class="cstat-no" title="statement not covered" >        require(msg.value &gt;= lockFee, "Please pay the fee")</span>;
<span class="cstat-no" title="statement not covered" >        require(_unlockTime &gt; block.timestamp, "The unlock time should in future")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        IERC20(_token).transferFrom(_msgSender(), address(this), _numOfTokens)</span>;
&nbsp;
        lockerCount++;
&nbsp;
<span class="cstat-no" title="statement not covered" >        loker[lockerCount] = Loker(</span>
            lockerCount,
            _type,
            _msgSender(),
            _token,
            _numOfTokens,
            block.timestamp,
            _unlockTime,
            Status.LOCKED
        );
&nbsp;
<span class="cstat-no" title="statement not covered" >        lockersListByUserAddress[_msgSender()].push(lockerCount)</span>;
<span class="cstat-no" title="statement not covered" >        lockersListByTokenAddress[_token].push(lockerCount)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit Locked (lockerCount, _msgSender(), _token, _numOfTokens, _unlockTime );</span>
&nbsp;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function unlockTokens(uint _id, uint _numOfTokens) public OnlyLockerOnwer(_id) Expired(_id) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        Loker memory lokerData = loker[_id];</span>
<span class="cstat-no" title="statement not covered" >        require(lokerData.numOfTokens &gt;= _numOfTokens, "Not enough tokens to withdraw")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        IERC20(lokerData.tokenAddress).transfer(_msgSender(), _numOfTokens)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        loker[_id].numOfTokens = lokerData.numOfTokens.sub(_numOfTokens)</span>;   
&nbsp;
<span class="cstat-no" title="statement not covered" >        if(loker[_id].numOfTokens == 0 ){</span>
<span class="cstat-no" title="statement not covered" >            loker[_id].status = Status.WITHDRAWED</span>;
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit Unlocked (_id, _msgSender(), lokerData.tokenAddress, _numOfTokens);</span>
&nbsp;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function addTokenstoALocker(uint _id, uint _numOfTokens) payable public OnlyLockerOnwer(_id) NotExpired(_id) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        require(msg.value &gt;= updateLokcerFee, "Please pay the updating fee")</span>;
<span class="cstat-no" title="statement not covered" >        require(_numOfTokens &gt; 0, "Tokens should be more than zero")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        IERC20(loker[_id].tokenAddress).transferFrom(_msgSender(), address(this), _numOfTokens)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        loker[_id].numOfTokens = loker[_id].numOfTokens.add(_numOfTokens)</span>;
&nbsp;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function increaseLocktime(uint _id, uint _additionTime) payable public OnlyLockerOnwer(_id) NotExpired(_id) {</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        require(msg.value &gt;= updateLokcerFee, "please pay the updating fee")</span>;
<span class="cstat-no" title="statement not covered" >        require(_additionTime &gt; 0, "Addition time should be more than zero")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        loker[_id].unlockTime = loker[_id].unlockTime.add(_additionTime)</span>;
&nbsp;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getLockersListbyUser(address _userAddress) public view returns (uint[] memory) {</span>
<span class="cstat-no" title="statement not covered" >        return lockersListByUserAddress[_userAddress];</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function getLockersListbyToken(address _tokenAddress) public view returns (uint[] memory) {</span>
<span class="cstat-no" title="statement not covered" >        return lockersListByTokenAddress[_tokenAddress];</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function updateFees(uint _lockFee, uint _updatingFee) public onlyOwner {</span>
<span class="cstat-no" title="statement not covered" >        lockFee = _lockFee</span>;
<span class="cstat-no" title="statement not covered" >        updateLokcerFee = _updatingFee</span>;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function withdrawFunds() public onlyOwner {</span>
<span class="cstat-no" title="statement not covered" >        uint balance = address(this).balance;</span>
<span class="cstat-no" title="statement not covered" >        require(balance &gt; 0, "Nothing to withdraw")</span>;
<span class="cstat-no" title="statement not covered" >        payable(_msgSender()).transfer(balance)</span>;
    }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Feb 06 2022 11:14:10 GMT+0500 (Pakistan Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
